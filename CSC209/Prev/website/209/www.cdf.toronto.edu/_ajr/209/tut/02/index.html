<!doctype html>
<html>


<!-- Mirrored from www.cdf.toronto.edu/~ajr/209/tut/02/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 00:59:02 GMT -->
<head>

<title>CSC 209 tutorial exercises, week of 18 January 2016</title>

<meta name=viewport content="width=device-width, initial-scale=1">

<style type="text/css">
    body {
        color: black;
        background-color: #ffdddd;
    }
    hr {
        border-style: solid;
    }
    div.toc {
        float: right;
        padding-left: 20px;
        padding-right: 20px;
        padding-top: 20px;
        padding-bottom: 20px;
        background-color: #cc7777;
        color: white;
        link: white;
        visited: white;
        line-height: 150%;
    }
    div.toc a:link {
        color: white;
    }
    div.toc a:visited {
        color: white;
    }

    .hidden { display: none; }
    .unhidden { display: block; }
</style>

<script type="text/javascript">
    function show(s) {
        document.getElementById(s).className = 'unhidden';
    }
    function reveal(s) {
        document.getElementById(s+'_a').className = 'hidden';
        document.getElementById(s+'_b').className = 'revealed';
    }
</script>

</head>

<body>

<div class=toc>
<a href="../01.html">Tutorial 01</a>
<br>
<a href="../02.html">Tutorial 02</a>
<br>
<a href="../03.html">Tutorial 03</a>
<br>
<a href="../04.html">Tutorial 04</a>
<br>
<a href="../05.html">Tutorial 05</a>
<br>
<a href="../06.html">Tutorial 06</a>
<br>
<a href="../07.html">Tutorial 07</a>
<br>
<a href="../08.html">Tutorial 08</a>
<br>
<a href="../09.html">Tutorial 09</a>
<br>
<a href="../10.html">Tutorial 10</a>
<br>
<a href="../11.html">Tutorial 11</a>
<br>
<a href="../12.html">Tutorial 12</a>
<br>
<p>
[<a href="../../index.html">Course home page</a>]
</div>

<h1>CSC 209 tutorial 02 exercises, week of 18 January 2016</h1>

Please begin by running "/student/csc209/present".
This records your attendance and is required for you to get the marks for the
lab.

<p>
In today's exercises
we will use "lynx", the text-mode web browser,
to do some exciting unix-tool stuff.

<p>
Lynx is a text-mode web browser, no GUI, which can be a very handy thing
in terms of "software tools".

<p>
In a terminal window, type
<pre>
	lynx http://www.google.ca
</pre>

<p>
You'll have to use the down-arrow a bunch of times to get to the
text entry field; then type something to search for; then pressing return
or down-arrow will get you to the "Google Search" button; then you can
press return to press this button.

<p>
Play with this a bit until you're in control of the tool.

<p>
Then quit out of lynx (with either 'q' or control-C) and try something else
instead:

<p>
First, run firefox or any graphical web browser, or since you're probably
already running a graphical web browser to look at this document, open a new
window.

<p>
Type "www.thinkbabynames.com" and press return, so that it goes to
http://www.thinkbabynames.com

<p>
Don't interact with the form at the top, but scroll just past item 3 and
press "random namer", and then select "female".

<p>
Press 'reload' to get another random name.

<p>
Now, let's do this in the shell so that we can put it in a program, and do
other stuff with the output.

<p>
Leave your web browser running, and triple-click in the URL bar (yes,
triple), so that the entire URL is selected.  (that is:
<pre>
http://www.thinkbabynames.com/random/0
</pre>
)

<p>
Switch to a terminal window, and click with the middle button to paste the
URL.

<p>
Use the arrows to edit it into a suitable command-line.  Press control-A to
go to the beginning of the line, or control-E to go to the end.  Control-D
deletes a character to the right.  (The normal delete or backspace key will
delete a character to the left.)

<p>
Put "lynx" at the beginning as the command name, then a space.

<p>
We also have to check the URL at this point to see if there are any funny
characters which are special to the shell; for example, many URLs have
'?' and '&amp;', and these would both need to be quoted.  However, in this case
there are no funny characters.

<p>
So press return to execute the command-line as you have edited it.
Now, the first thing you will notice is that this is excessively interactive.
Good software tools need to be non-interactive, at least as an option.  Lynx
has such an option, called "dump", preceded by a single minus sign.

<p>
So (after typing 'q' to get out of lynx, or more simply control-C),
<ul>
<li> press up-arrow to recall (and edit) the previous line,

<li> add the '-dump' option between 'lynx' and the URL, with spaces on both sides
(remember control-A to go to the beginning of the line)
</ul>

<p>
How would we pick the name out of there for further use?

<p>
Instead of -dump, try -source.  [try it]

<p>
This is the HTML data which the web server transmits, which the browser
interprets so as to make a nice-looking layout.

<p>
But it's structural, so it's easier to extract things from.

<p>
Scroll up to a ridiculously huge (wide) line (it's about 10000 characters long;
if your terminal window is 80 chars wide it will take up around 120 lines),
which contains the names and definitions.
(This is just several "lines" before the end of the file, but two more lines
on your way are still quite huge, although they're in the thousand-character
width range rather than ten-thousands.)
<br>
Look at the beginning of this a little before reading further.

<p>
After some examination (more than you probably felt worth spending time on
just now),
we notice that the easiest place to find the names is probably in the URL
where it says
&lt;a href="/meaning/0/<i>whatever</i>"&gt;
<br>
... probably easier than to find the names themselves in the displayed data!
The "a href=" URLs contain the substring "meaning/0/"
and after that last slash there's the word in question, which will be easy
to extract.

<p>
So append to that "lynx -source" command-line:

<pre>
	| tr -s SOMETHING '\012'
</pre>

where "SOMETHING" is what you need to work on.

<p>
For "SOMETHING", we want to list all characters that we want to turn into
newlines, thus making it one interesting string per line, and then we'll use
grep etc.  The "-s" makes it turn runs of multiple bad characters into single
newlines.

<p>
Actually, it's easier to say the list of characters we <i>don't</i> want to turn
into newlines.  So add the "-c" option, for "complement".

<p>
As a start, let's take just letters.

<p>
<div id="tr_a" class=revealed>
[<a href="javascript:reveal('tr');">formulate your command-line, then click here
to reveal my solution</a>]
</div>
<div id="tr_b" class=hidden>
So now the whole line should look like:
<pre>
	lynx -source http://www.thinkbabynames.com/random/0 | tr -cs a-z '\012'
</pre>
</div>

<p>
But we've lost the "/meaning/0" bit we want to grep on... and we lose the
capital letters at the beginning of the names!  So change the pattern from
simply "a-z" to "/0-9A-Za-z" -- slashes, digits, capital letters, lower-case
letters.

<p>
Now remember "grep", the pattern-matching command.  It copies only the
lines which match the supplied pattern (the pattern can occur anywhere
in the line).

<p>
So press up-arrow to recall the line and then append "| grep meaning/0"

<p>
So now we've got the basic data, but it needs cleaning up.  What next?

<p>
Fortunately the cleanup is easy.  We want to delete everything to the last
slash.

<p>
For this, we will use:
<pre>
	sed 's;.*/;;'
</pre>

<p>
Usually we use '/' as the delimiter in sed 's' commands -- that's the usual choice --
but if we have a search or replace pattern which <i>contains</i> slashes, it can
be easier to use something else.  Whatever non-whitespace character follows
the 's' is automatically the delimiter.  ';' is the usual second choice.

<p>
';' and '*' are both special to the shell, so they need quoting -- it's
easiest just to quote the whole thing.  Actually for sed's 's' command,
we need quotes around the command argument more often than not.

<p>
Altogether we've now got:
<br>
<div id="sed_a" class=revealed>
[<a href="javascript:reveal('sed');">formulate your command-line, then click
here to reveal my solution</a>]
</div>
<div id="sed_b" class=hidden>
<pre>
	lynx -source http://www.thinkbabynames.com/random/0 | tr -cs /0-9A-Za-z '\012' | grep meaning/0 | sed 's;.*/;;'
</pre>
</div>

<p>
One further thing.  Let's put the two names on the same line, and also put it
in a sentence.  "echo" can be good for building up an output line with various
components.  We can use backquotes to substitute in the outputs of commands.
Since "echo" separates its command-line arguments with spaces when it outputs
them, this will regularize the output, e.g. in this case change the newline
between the two names into a space.

<p>
So prepend
<pre>
	echo I would like to introduce my friend `
</pre>
to that line (with the backquote), and append
<pre>
	`.
</pre>
(backquote period)

<p>
Note the difference between normal single quotes and backquotes.  In the
<cite>sh</cite> input language, they have completely different semantics, and
backquotes don't do any quoting at all -- almost the opposite, they cause an
extra execution of the enclosed text.

<p>
<div id="final_a" class=revealed>
[<a href="javascript:reveal('final');">click here to reveal the final version</a>]
</div>
<div id="final_b" class=hidden>
(for reference, the line is now
<pre>
	echo I would like to introduce my friend `lynx -source http://www.thinkbabynames.com/random/0
	| tr -cs /0-9A-Za-z '\012' | grep meaning/0 | sed 's;.*/;;'`.
</pre>
except all on one line.)
</div>


<p>
<hr>

<h3> Aliases </h3>

<p>
You sure typed "lynx -source" a lot.  Except you probably didn't because you
were pressing up-arrow.  But you can't easily recall previous commands
with up-arrow
forever.
Let's look at a better solution for this sort of thing.

<p>
Try typing this command:

<pre>
	alias dump lynx -dump
</pre>

<p>
Then instead of saying "lynx -dump URL", you can just say "dump URL".  Try some
of the earlier examples with this.  This can be useful when there's something
we write a lot, or to add default arguments to certain commands.

<p>
A more practical example:

<pre>
	alias rm rm -i
</pre>

<p>
Now when we type "rm file", it will ask us before deleting it.  This alias
might be in your account by default, as described next.

<p>
Type "alias" (return) to see a list of all existing aliases.

<p>
But if you close the terminal window and open a new one, you'll lose your
"dump" alias.
In this case that's probably just as well, but in general,
how do we make aliases "stick"?  Answer: Add 'alias' commands into a file
which gets executed upon login or when the terminal window is created.
The shell reads commands from a file ".cshrc" in your home directory when
started, so add this alias command there.
<!--
Actually, in "bash" there are two files in question, called ".bashrc" and
".bash_profile".
.bash_profile is executed when you log in; .bashrc is executed for all other
shells.
So usually we put the aliases in .bashrc, and arrange for .bashrc also to be
run by .bash_profile (this is usually in place in the system by default).
-->
However, you must take care not to put any commands in your .cshrc which
require interactivity or require a terminal; those should go in
a separate file named .login.  Commands in the .cshrc file are always executed
whenever a shell is started; commands in .login are then executed only when it
thinks it's a "login shell".

<p>
The 'alias' syntax for "sh" (as opposed to "csh") is different,
unfortunately.  But since aliases are for interactive purposes, you'll
probably only need to make them in csh, your login shell.


<p>
<hr>
<p>

<h2> To submit </h2>

<p>
First of all, you must run "/student/csc209/present",
during the tutorial time, on the console of a tutorial lab workstation.

<p>
Then, by midnight at the end of your tutorial day, you must
submit a solution to the following small problem.

<p>
If you change the '0' to '1' at the end of
"http://www.thinkbabynames.com/random/0", you get male names -- '0' gives
you female names, '1' gives you male names.

<p>
Write a command in a file named "tut2" which prints one male name
(not two -- e.g. "Jacob" rather than "Jacob John").
Do not use 'echo' and backquotes like we did at the end above (the output of
your pipeline will already be the desired output).

<p>
Note that you can test your submission by typing "sh tut2" to run this
command through the shell.
But you probably want to develop it incrementally in the same way that we
did above (and still test with "sh tut2" at the end).

<p>
Submit with the command
<pre>
	/student/csc209/submit tut2 tut2
</pre>

<p>
Note in this command that the first "tut2" is the "assignment" name you are
submitting under, and the next "tut2" is the file to submit.
<br>
You may still change your file and resubmit it any
time up to the due time, using the same command; and you can use "submit -l"
as described in <a href="../01/index.html">tutorial one</a>.


<p>
<hr>
<p>

<h2> Coming next week </h2>

Next week's tutorial involves writing a man page.
There is some documentation about man page writing which you might want to
begin skimming in advance.
See
<a href="../03/index.html">the tutorial assignment page for next week</a>.

<p>
<hr>

</body>

<!-- Mirrored from www.cdf.toronto.edu/~ajr/209/tut/02/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 13 Jan 2017 00:59:02 GMT -->
</html>
